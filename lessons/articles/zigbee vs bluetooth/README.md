### Zigbee vs Bluetooth - разбираемся в тонкостях    

:arrow_right: [Вернуться к оглавлению](https://github.com/kvazis/training/tree/master/lessons/articles/articles)

В последнее время на рынке стало появляться все больше умных устройств, работающих по протоколу Bluetooth Mesh, вместо ставшего уже привычным Zigbee. Что, конечно, стало вызывать все больше вопросов - а что же лучше и что выбрать?    
Беспроводные протоколы Zigbee и Bluetooth широко используются для локальной связки устройств Интернета вещей (IoT), которые составляют основу умного дома. Каждый из них имеет свои особенности - как достоинства, так и недостатки.    
Чтобы лучше понять параметры этих протоколов IoT, давайте рассмотрим преимущества и ограничения Zigbee, а затем то же самое для трех разных вариантов Bluetooth - классический вариант, BLE и BT Mesh.    

#### Zigbee    
**Zigbee** - это открытый глобальный стандарт беспроводных ячеистых сетей с низким энергопотреблением и низкой пропускной способностью, разработанный консорциумом компаний, входящих в Zigbee Alliance. Протокол Zigbee позволяет передавать данные на довольно большие расстояния, передавая информацию через ячеистую сеть промежуточных узлов-роутеров. Диапазон частот 2,4 ГГц Zigbee может быть реализован по всему миру без специального лицензирования.    
Преимущества протокола Zigbee    
С помощью Zigbee можно создавать крупные разветвленные сети, размер которых может многократно превышать радиус действия любого из ее узлов. Сеть Zigbee формируется автоматически и динамически реконфигурируется, чтобы восстановить себя, если какие-то узлы отключены или удалены (самовосстановление).    
Центральной точкой такой сети является **координатор** (именно эту роль играют шлюзы, они же хабы, различные Zigbee стики и т.п.).    
Далее, роль узлов выполняют **роутеры** - это подавляющее большинство устройств со стационарным питанием (и нулевой линией): розетки, реле, выключатели, светильники и.т.п. Роутеры могут подключать через себя и другие роутеры, строя длинные цепочки связей.    
И **конечные устройства** - на них цепь связей обрывается, дальше через себя они ничего не передают - это различные датчики, сенсоры, выключатели и реле без нулевой линии. Энергоэффективность сети Zigbee позволяет им работать долгие годы от одной батарейки.    
Документация по протоколу имеется в свободном доступе и охватывает множество различных вариантов использования. Таблицы маршрутизации и адресации, безопасность, повторные попытки и подтверждения встроены прямо в протокол, что значительно экономит время разработки.    
Следование стандартам позволяет устройствам разных производителей беспрепятственно обмениваться данными, что привело к широкому применению Zigbee в домашней автоматизации. На рынке имеется множество вариантов оборудования, причем по весьма скромным ценам.    

#### Недостатки протокола Zigbee    
Как и большинство ячеистых сетей, узлы Zigbee - роутеры, которые маршрутизируют сообщения, должны быть постоянно включены. Конечные устройства, которые могут переходить в спящий режим для продления срока службы батареи, являются частью общей сети, но не продлевают ее, так как не могут передавать сообщения от других узлов.    
Zigbee не использует IP-адресацию. Поэтому для связи с центрами управления умным домом, интернетом или облачными сервисами необходимы шлюзы, о которых я сказал выше.    

#### Bluetooth    
**Bluetooth** - это протокол беспроводной сети, предназначенный для связи на небольших расстояниях. Первоначально он был создан для замены проводов, необходимой для подключения таких устройств, как компьютеры и смартфоны, к их периферийным устройствам, таким как наушники, клавиатуры и мыши. Подобно Wi-Fi и Zigbee, он работает в диапазоне частот 2,4 ГГц, который во всем мире не требует лицензии.    

#### Bluetooth Classic    
**Bluetooth Classic** предназначен для передачи данных с скоростью до 2,1 Мбит/с на короткие расстояния, где нет необходимости в длительной автономной работе. Это отличное решение для аудио- и видеоустройств, которым требуется широкая полоса пропускания и которые можно заряжать каждый день. Это мобильные гарнитуры, наушники, клавиатуры, мыши, принтеры и другие периферийные устройства, обычно подключенные к компьютеру, автомобильной мультимедийной системе или смартфону. Bluetooth использует архитектуру мастер - клиент. Один мастер может связываться с семью клиентскими устройствами.    

#### Преимущества Bluetooth Classic    
Если необходимо отправлять или получать большой объем данных, вам пригодится высокая пропускная способность **Bluetooth Classic**. Есть много устройств, которые реализуют этот протокол. Для аудио- и видеопотоков легко подключить смартфон, планшет, ноутбук или телевизор. **Bluetooth Classic** - очень развитый протокол, и документация широко доступна в книгах, в Интернете и, конечно, в официальной документации по стандартам.    

#### Ограничения Bluetooth Classic    
**Bluetooth Classic** может быть довольно сложным в реализации, требующим ручного сопряжения для управления этим процессом. Его высокая пропускная способность также означает, что он относительно энергоемкий. Протокол разработан для устройств со стационарным питанием, или которые легко заряжать ежедневно, что делает его непригодным для многих приложений IoT. Сети весьма ограничены по размеру, поскольку протокол был разработан для замены периферийных кабелей, а не для масштабируемых сетей, в которых размещены сотни устройств.    

#### Bluetooth BLE    
**Bluetooth Low Energy (BLE)** поддерживает соединения с низкой пропускной способностью на короткие расстояния с отличной энергоэффективностью. Он используется в ситуациях, когда сеть не должна обрабатывать большие потоки данных, и где батареи должны работать месяцы или даже годы. Примеры **BLE** устройств - трекеры для определения местоположения, цифровые весы, сенсоры температуры влажности, освещения, умные часы, кухонная техника и тысячи других устройств, где не требуется широкая полоса пропускания данных.    
**BLE** реализует архитектуру сервер - клиент, которая позволяет аппаратному обеспечению реализовывать только самые необходимые функции связи, экономя заряд батареи и полосу пропускания. Сети **BLE** теоретически могут содержать огромное количество устройств, хотя пропускная способность, расстояние и, самое главное, диапазон ограничивают размер одной персональной сети **BLE** до нескольких сотен узлов.    

#### Преимущества BLE    
Главное преимущество - прямо в названии, **Bluetooth Low Energy** не потребляет много энергии. Устройства могут работать от батареек -таблеток в течение длительного времени, что делает его предпочтительным протоколом для устройств с небольшой передачей данных, которым необходимо автономно работать в течение нескольких месяцев. Кроме этого, чипы и устройства **BLE** имеют невысокую стоимость, обычно дешевле чем **Zigbee**.    
Архитектура сервер - клиент упрощает реализацию коммуникаций, сокращая время проектирования и разработки. Это также означает, что устройства не должны быть сопряжены для связи, но могут считывать и отправлять данные асинхронно и мгновенно, когда это необходимо. Протокол широко применяется и реализуется на миллиардах устройств по всему миру.    

#### Ограничения BLE    
**BLE** - это протокол точка-точка. Следовательно, участники сети не могут общаться за пределами своего индивидуального диапазона. Это ограничивает физический размер сетей типичным для **BLE** 10-метровым диапазоном, что, в принципе, достаточно для квартир, жилых домов и небольших офисов.    
Аналогично **Zigbee**, тут IP-адресация не реализована, поэтому необходимо использовать шлюзы, однако тут, в отличии от **Zigbee**, шлюзов может быть несколько одновременно.    

#### Bluetooth Mesh    
**Bluetooth Mesh (BT Mesh)** - это относительно новый протокол. Он расширяет архитектуру **BLE** - точка-точка, используя дополнительные стандарты маршрутизации и формирования сети для создания ячеистых сетей, в которых узлы могут действовать как ретрансляторы для расширения сети за пределы диапазона любого одного устройства. **BT Mesh** в целом похож на **Zigbee** по функциям и архитектуре, но имеет несколько очень важных отличий. Сеть **BT Mesh** теоретически может поддерживать более 32 тысяч узлов, однако, как и другие протоколы, практические ограничения полосы пропускания и физического пространства обычно ограничивают отдельные сети до нескольких сотен устройств.    

#### Преимущества Bluetooth Mesh    
Сети, сформированные в виде ячеистой сети, не ограничены радиусом действия какого-либо отдельного узла. Вместо этого, каждый узел может пересылать и маршрутизировать сообщения адресатам, выходящим далеко за пределы их диапазона, образуя очень большие физические сети. Поскольку **Bluetooth Mesh** основан на **BLE**, он обладает многими преимуществами этого протокола, включая низкое энергопотребление, хорошую безопасность, поддержку маяков и обширную базовую документацию. Сети **BT Mesh** являются самоформирующимися и самовосстанавливающимися, с поддержкой спящего режима для конечных устройств с сохранением связи - ретранслятор - точка, аналогично, как в **Zigbee**.    

#### Ограничения Bluetooth Mesh    
**Bluetooth Mesh** по-прежнему является новым протоколом, и он все ещё находится в состоянии усовершенствования и доработки. Он еще не получил такой широкой поддержки, как **Zigbee**, а это означает, что, шлюзы, ретрансляторы, конечные устройства, все еще полностью не совместимы, хотя все идет именно к этому.    
Любое устройство, которое выполняет маршрутизацию, должно получать питание от сети, а не от батареи, потому что, как и роутерам **Zigbee**, маршрутизаторам **BT Mesh** не разрешен спящий режим. Они не используют IP-адресацию, поэтому внешнее взаимодействие должно осуществляться через фиксированные шлюзы, которые осуществляют преобразование между **BLE** и обычным протоколом Интернета. Ячеистые сети всегда имеют более высокую задержку, поскольку сообщения могут перемещаться через несколько узлов на пути к месту назначения, поэтому приложения должны иметь возможность выдерживать более длительное время отклика, в обмен на более крупный масштаб ячеистой сети.    

#### Что же в сухом остатке?    
**Zigbee** и **Bluetooth** полезны в различных типах решений IoT. Главное - они могут работать вместе для создания чрезвычайно гибких приложений, сочетающих сильные стороны каждого протокола.    
На сегодняшний день, с точки зрения доступности на рынке, **Zigbee** вне конкуренции, есть полный спектр как датчиков - конечных устройств, так и роутеров, устройств со стационарным питанием. **Bluetooth mesh** пока только развивается, но тем не менее в продаже появляются все больше новых IoT гаджетов с поддержкой этого протокола.    

____
#### Поддержать развитие проекта *Умный дом с Alex Kvazis*    
<a href="https://www.youtube.com/channel/UCcq9onYHbs6go3kDpfBoqhg/join" target="_blank"><img src="https://raw.githubusercontent.com/kvazis/training/master/lessons/img/youtube.png" alt="Youtube Sponsorship" style="height: 41px !important;width: 174px !important;box-shadow: 0px 3px 2px 0px rgba(190, 190, 190, 0.5) !important;-webkit-box-shadow: 0px 3px 2px 0px rgba(190, 190, 190, 0.5) !important;" ></a>
<a href="https://www.patreon.com/alex_kvazis" target="_blank"><img src="https://raw.githubusercontent.com/kvazis/training/master/lessons/img/patreon-button.png" alt="Patreon Support" style="height: 41px !important;width: 174px !important;box-shadow: 0px 3px 2px 0px rgba(190, 190, 190, 0.5) !important;-webkit-box-shadow: 0px 3px 2px 0px rgba(190, 190, 190, 0.5) !important;" ></a>
<a href="https://www.buymeacoffee.com/greatkvazis" target="_blank"><img src="https://raw.githubusercontent.com/kvazis/training/master/lessons/img/buymeacoffee.png" alt="Buy Me A Coffee" style="height: 41px !important;width: 174px !important;box-shadow: 0px 3px 2px 0px rgba(190, 190, 190, 0.5) !important;-webkit-box-shadow: 0px 3px 2px 0px rgba(190, 190, 190, 0.5) !important;" ></a>
<a href="https://www.paypal.com/paypalme/greatkvazis" target="_blank"><img src="https://raw.githubusercontent.com/kvazis/training/master/lessons/img/paypal.png" alt="PayPal Me" style="height: 41px !important;width: 174px !important;box-shadow: 0px 3px 2px 0px rgba(190, 190, 190, 0.5) !important;-webkit-box-shadow: 0px 3px 2px 0px rgba(190, 190, 190, 0.5) !important;" ></a>

#### Или перевод любой суммы на -     
* Webmoney - Z243592584952
* BTC - 1Gzr7WQugfnPuWVawu47EiCMTDUBqCAshj
* ETH - 0xa0ce3E29Cf537013649Ae9cdbc08C4853fF91FAc
* LTC - ltc1qs493yk2wk9ywx5h6aruk4p9zm75hx42ekv4ym2
* TRX - TFTCLqvS1tMBwokRHBwz1TCDJ4oD1Z5zPk